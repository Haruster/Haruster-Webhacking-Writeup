- 오늘은 Lord of SQL Injection의 문제인 goblin을 한번 풀어보도록 하겠습니다.

![](https://images.velog.io/images/dsph9245/post/f8f5f5fb-dbff-4040-b99c-1adba4b3f4da/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.18.59.png)

![](https://images.velog.io/images/dsph9245/post/910e5957-6489-4371-a096-044c3c64db13/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.19.09.png)

- 일단 문제 서버에 접속을 해서 아래의 쿼리문과 php로 작성되어있는 소스코드를 살펴보겠습니다.

- 일단 싱글 쿼터('), 더블 쿼터(") 다 필터링 처리가 되어 있네요.... 

![](https://images.velog.io/images/dsph9245/post/cf8de755-7677-4859-b461-6441a789ba34/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.19.15.png)

- 쿼리문에서 힌트를 얻어서 id가 아닌 no=로 접근을 한 번 해보겠습니다.

![](https://images.velog.io/images/dsph9245/post/5f0d65db-a91e-4a6e-aa19-3b2a92e00b7c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.13.png)

![](https://images.velog.io/images/dsph9245/post/2e33b3f9-e6a7-4b49-8782-6d1d2345cb80/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.16.png)

- 한번 제일 먼저 no= 뒤에 id라는 문자열을 넣어보았습니다.

![](https://images.velog.io/images/dsph9245/post/b23b5a5a-92fe-4bf8-9165-a59080a35f7b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.30.png)

- 그러니 no=id라는 쿼리가 출력됨을 볼 수 있습니다.

![](https://images.velog.io/images/dsph9245/post/9ed79deb-9ed4-48be-8495-9276ded6f42a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.33.png)

- 그럼 다음으로 no=0을 넣어보도록 하겠습니다.

![](https://images.velog.io/images/dsph9245/post/f714a0c6-9203-403b-97c0-4b9175bf0712/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.41.png)

- no=0을 넣으니 아까와 같이 쿼리문에 no=0이 그대로 출력이 되는 것을 확인할 수 있습니다.

![](https://images.velog.io/images/dsph9245/post/e2597768-67ee-4f6a-b590-2f398c43de22/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.43.png)

- 다음으로 no=1을 넣어보겠습니다.

![](https://images.velog.io/images/dsph9245/post/c1a3b4c6-8a98-4604-868b-b34a40bce04b/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.50.png)

- no=1을 넣으니 guest권한으로 로그인이 되는 것을 알 수 있습니다.

![](https://images.velog.io/images/dsph9245/post/8ed8ac98-0fc9-404d-9198-38093349e17e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.20.53.png)

- 그럼 마지막으로 admin을 no=뒤에 넣어보겠습니다.

![](https://images.velog.io/images/dsph9245/post/5e4cc1c0-3ab4-4620-887d-721a38bac75f/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.21.04.png)

- 음,,,, 당연하게도 admin이 그대로 출력되네요.

- 이걸로 저희는 숫자 1이 guest이고 문자열은 그대로 출력되고 숫자 0도 그대로 출력된다는 것을 알 수 있습니다.

- 근데, 저는 여기서 0이 admin 즉, root를 나타낸다고 생각을 하게 되었습니다. (실제로 리눅스 내 권한에서도 root가 0을 가진다는 걸 들은 적 있는 것 같아서,,,,)

![](https://images.velog.io/images/dsph9245/post/f56d76d3-8e81-4b75-9a4f-3cadd4490c42/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.21.06.png)

- 암튼, no=0이라는 값 뒤에 id=admin이 붙어야 한다는 것을 알 수 있습니다.

- 그럼 다음으로 url에 no=0 or id=admin을 넣어보겠습니다.

![](https://images.velog.io/images/dsph9245/post/03a2c221-72dc-4559-bc67-8481d9902666/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%2010.24.13.png)

- admin이라는 문자열이 필터링처리가 되는 것 같습니다.(제대로 실행이 되지 않습니다.)

![](https://images.velog.io/images/dsph9245/post/c3e2dbfa-66a8-493f-9619-1da7263a9a4e/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%2010.23.09.png)

- 그러면 admin이라는 문자열이 필터링이 되는 것이기 때문에 admin이라는 문자열을 hex값으로 바꾸어서 이를 서버에 전송해주면 제대로된 값이 나오지 않을까?라고 생각을 하게 되어 변환기를 돌려보았습니다.

![](https://images.velog.io/images/dsph9245/post/f0e58fe2-79ba-45ec-ad70-222c9b86f6a2/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.21.20.png)

- 인터넷에 찾아본 결과 php는 hex값을 입력 받을 때 앞에 0x를 붙어야 한다고 하네요.(0x61646d696e)

```
no=0 or id=0x61646d696e
```

![](https://images.velog.io/images/dsph9245/post/41765072-7886-475c-b11e-2eece3a7b23a/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.23.20.png)

- 그러면 아래와 같이 clear가 되는 것을 확인할 수 있습니다.

![](https://images.velog.io/images/dsph9245/post/7e1f7766-4c60-474a-a345-ad5f41197084/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA%202022-01-09%20%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE%209.23.43.png)

